# poketier

## ディレクトリ構成

```
poketier/
├── backend/
│   ├── cmd/
│   │   └── poketier/
│   │       └── main.go           # エントリーポイント
│   ├── .air.toml                 # Air設定ファイル
│   ├── go.mod
│   └── go.sum
├── build/
│   └── Dockerfile_local          # 開発用Dockerfile
├── docker-compose.yml            # Docker構成
├── Makefile                      # 開発用コマンド
└── .vscode/
    └── launch.json               # VSCodeデバッグ設定
```

## 技術スタック

- **Backend**
   - **Go**: 1.24.4
   - **フレームワーク**: Gin
   - **ORM**: sqlc（予定）
   - **デバッガー**: Delve
   - **ホットリロード**: Air

## ローカル開発環境

### 仕組み
VSCodeでの開発を想定しています。
ホストマシンにDockerがインストールされている事を前提としています。

1. **Docker環境**：
   - `docker-compose up -d` でコンテナを起動
   - コンテナ起動時に自動でAir（ホットリロード）+ Delve（デバッガー）が起動
   - ファイル変更時に自動的にGoアプリが再ビルド・再起動
   - ポート：`28080`（アプリ）、`2345`（デバッガー）

2. **統合開発環境**：
   - **ホットリロード**: ファイル変更時の自動再起動
   - **デバッグ機能**: ブレークポイントで詳細デバッグ
   - **両方同時利用**: 開発効率とデバッグ能力を両立

### 開発手順

#### 1. 環境構築

```bash
# コンテナをビルド・起動（Air + Delveが同時起動）
make build && make up
```

#### 2. 推奨開発手順

1. VS Codeで `F5` を押してデバッガー接続（"Attach to Backend Server"を選択）
2. ファイルを編集・保存
3. Airが自動的に変更を検知してサーバー再起動（3-5秒待機）
4. **VS Codeで再度 `F5` を押してデバッガー再接続**
5. ブレークポイントやログで動作確認

#### 3. バックエンドサーバーにアクセス

```bash
# ヘルスチェック
curl http://localhost:28080/health
```

#### 4. 開発終了

```bash
# コンテナを停止・削除
make down
```

### ポート一覧

| サービス | ホスト | コンテナ | 用途 |
|---------|--------|----------|------|
| バックエンドサーバー | 28080 | 8080 | HTTP API |
| Delveデバッガー | 2345 | 2345 | リモートデバッグ |
